<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-20 Sa 12:17 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clamps Packages</title>
<meta name="author" content="Orm Finnendahl" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../css/clamps.css" />
<link rel="stylesheet" type="text/css" href="../css/htmlize.css" />
<link rel="stylesheet" type="text/css" href="../css/themes.css" />
<link href="./pagefind/pagefind-ui.css" rel="stylesheet">
<script src="./pagefind/pagefind-ui.js"></script>
<script src="../js/clamps-doc.js"></script>
</head>
<body>
<div id="preamble" class="status">
<a class="top-menu" href="../overview/index.html">Overview</a>
<a class="top-menu top-menu-active" href="./index.html">Clamps Packages</a>
<a class="top-menu" href="../cm-dict/index.html">CM Dictionary</a>
<a class="top-menu" href="../clamps-dict/index.html">Clamps Dictionary</a>
<a class="top-menu" href="../fomus/index.html">Fomus</a>
</div>
<div id="org-div-nav-menu">Next: <a accesskey="n" href="07_03_01_00_loading-sfz-files.html"> Loading sfz files </a>,&nbsp;Previous: <a accesskey="p" href="07_02_04_00_the-bang-object-class.html"> The bang-object class </a>,&nbsp;Up: <a accesskey="u" href="07_00_00_00_misc-packages.html"> Misc Packages </a>,&nbsp;Home: <a accesskey="h" href="01_00_00_00_general.html"> General </a></div><div id="content" class="content">
<nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul class="ul-toc-level-1">
<li class="toc-level-1"><a href="01_00_00_00_general.html"class="toc-entry">General</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="01_00_00_00_general.html"class="toc-entry">Clamps Packages Overview</a>
<ul class="ul-toc-level-3">
<li class="toc-hidden toc-level-3"><a href="01_00_00_00_general.html"class="toc-entry">Package Naming</a></li>
<li class="toc-hidden toc-level-3"><a href="01_01_02_00_reading-the-documentation.html"class="toc-entry">Reading the Documentation</a></li>
</ul>
</li>
<li class="toc-hidden toc-level-2"><a href="01_02_00_00_clamps.html"class="toc-entry">clamps</a>
<ul class="ul-toc-level-3">
<li class="toc-hidden toc-level-3"><a href="01_02_00_00_clamps.html"class="toc-entry">Symbols</a></li>
<li class="toc-hidden toc-level-3"><a href="01_02_02_00_startup.html"class="toc-entry">Startup</a></li>
<li class="toc-hidden toc-level-3"><a href="01_02_03_00_emacs-shortcuts.html"class="toc-entry">Emacs Shortcuts</a></li>
<li class="toc-hidden toc-level-3"><a href="01_02_04_00_gui.html"class="toc-entry">GUI</a></li>
<li class="toc-hidden toc-level-3"><a href="01_02_05_00_meter-display.html"class="toc-entry">Meter Display</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-level-1"><a href="02_00_00_00_midi.html"class="toc-entry">Midi</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="02_00_00_00_midi.html"class="toc-entry">cl-midictl</a>
<ul class="ul-toc-level-3">
<li class="toc-hidden toc-level-3"><a href="02_01_01_00_midi-ports.html"class="toc-entry">MIDI Ports</a></li>
<li class="toc-hidden toc-level-3"><a href="02_01_02_00_midi-output.html"class="toc-entry">MIDI Output</a></li>
<li class="toc-hidden toc-level-3"><a href="02_01_03_00_midi-input.html"class="toc-entry">MIDI Input</a>
<ul class="ul-toc-level-4">
<li class="toc-hidden toc-level-4"><a href="02_01_03_00_midi-input.html"class="toc-entry">Receiving and handling MIDI Input</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_03_02_example-using-​midi-cc-fns​.html"class="toc-entry">Example using *​midi-cc-fns​*</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_03_03_example-using-​midi-cc-state​.html"class="toc-entry">Example using *​midi-cc-state​*</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_03_04_example-using-incudine-responders.html"class="toc-entry">Example using Incudine responders</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_03_05_exercise.html"class="toc-entry">Exercise</a></li>
</ul>
</li>
<li class="toc-hidden toc-level-3"><a href="02_01_04_00_midi-controllers.html"class="toc-entry">MIDI Controllers</a>
<ul class="ul-toc-level-4">
<li class="toc-hidden toc-level-4"><a href="02_01_04_01_using-a-korg-nanokontrol2-controller.html"class="toc-entry">Using a Korg NanoKONTROL2 Controller</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_04_02_other-utility-functions.html"class="toc-entry">Other Utility Functions</a></li>
<li class="toc-hidden toc-level-4"><a href="02_01_04_03_excursion-closures.html"class="toc-entry">Excursion: Closures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-hidden toc-level-2"><a href="02_02_00_00_clog-midi-controller.html"class="toc-entry">clog-midi-controller</a></li>
</ul>
</li>
<li class="toc-level-1"><a href="03_00_00_00_cm-extensions.html"class="toc-entry">CM Extensions</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="03_00_00_00_cm-extensions.html"class="toc-entry">General</a></li>
<li class="toc-hidden toc-level-2"><a href="03_02_00_00_cm-incudine.html"class="toc-entry">cm-incudine</a></li>
<li class="toc-hidden toc-level-2"><a href="03_03_00_00_cm-fomus.html"class="toc-entry">cm-fomus</a></li>
<li class="toc-hidden toc-level-2"><a href="03_04_00_00_cm-sfz.html"class="toc-entry">cm-sfz</a></li>
<li class="toc-hidden toc-level-2"><a href="03_05_00_00_cm-svg.html"class="toc-entry">cm-svg</a>
<ul class="ul-toc-level-3">
<li class="toc-hidden toc-level-3"><a href="03_05_01_00_export-to-svg.html"class="toc-entry">Export to SVG</a></li>
<li class="toc-hidden toc-level-3"><a href="03_05_02_00_import-from-svg.html"class="toc-entry">Import from SVG</a></li>
<li class="toc-hidden toc-level-3"><a href="03_05_03_00_inkscape-playback.html"class="toc-entry">Inkscape Playback</a></li>
</ul>
</li>
<li class="toc-hidden toc-level-2"><a href="03_06_00_00_cm-svg.rts.html"class="toc-entry">cm-svg.rts</a></li>
<li class="toc-hidden toc-level-2"><a href="03_07_00_00_cm-poolevt.html"class="toc-entry">cm-poolevt</a></li>
<li class="toc-hidden toc-level-2"><a href="03_08_00_00_cm-utils.html"class="toc-entry">cm-utils</a></li>
</ul>
</li>
<li class="toc-level-1"><a href="04_00_00_00_incudine-extensions.html"class="toc-entry">Incudine Extensions</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="04_00_00_00_incudine-extensions.html"class="toc-entry">General Incudine Setup</a></li>
<li class="toc-hidden toc-level-2"><a href="04_02_00_00_of-incudine-dsps.html"class="toc-entry">of-incudine-dsps</a></li>
<li class="toc-hidden toc-level-2"><a href="04_03_00_00_incudine-bufs.html"class="toc-entry">incudine-bufs</a></li>
</ul>
</li>
<li class="toc-level-1"><a href="05_00_00_00_gui.html"class="toc-entry">Gui</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="05_00_00_00_gui.html"class="toc-entry">General GUI Setup</a></li>
<li class="toc-hidden toc-level-2"><a href="05_02_00_00_clog-dsp-widgets.html"class="toc-entry">clog-dsp-widgets</a></li>
<li class="toc-hidden toc-level-2"><a href="05_03_00_00_ats-cuda-display.html"class="toc-entry">ats-cuda-display</a></li>
</ul>
</li>
<li class="toc-level-1"><a href="06_00_00_00_networking.html"class="toc-entry">Networking</a>
<ul class="ul-toc-level-2">
<li class="toc-hidden toc-level-2"><a href="06_00_00_00_networking.html"class="toc-entry">cuda-usocket-osc</a></li>
<li class="toc-hidden toc-level-2"><a href="06_02_00_00_fudi.html"class="toc-entry">fudi</a></li>
</ul>
</li>
<li class="toc-level-1"><a href="07_00_00_00_misc-packages.html"class="toc-entry">Misc Packages</a>
<ul class="ul-toc-level-2">
<li class="toc-level-2"><a href="07_00_00_00_misc-packages.html"class="toc-entry">ats-cuda</a></li>
<li class="toc-level-2"><a href="07_02_00_00_cl-refs.html"class="toc-entry">cl-refs</a>
<ul class="ul-toc-level-3">
<li class="toc-hidden toc-level-3"><a href="07_02_01_00_a-short-example.html"class="toc-entry">A short example</a></li>
<li class="toc-hidden toc-level-3"><a href="07_02_02_00_the-ref-object-class.html"class="toc-entry">The ref-object class</a></li>
<li class="toc-hidden toc-level-3"><a href="07_02_03_00_defining-relations.html"class="toc-entry">Defining relations</a></li>
<li class="toc-hidden toc-level-3"><a href="07_02_04_00_the-bang-object-class.html"class="toc-entry">The bang-object class</a></li>
</ul>
</li>
<li class="toc-level-2"><a href="07_03_00_00_cl-sfz.html"class="toc-entry toc-active">cl-sfz</a>
<ul class="ul-toc-level-3">
<li class="toc-level-3"><a href="07_03_01_00_loading-sfz-files.html"class="toc-entry">Loading sfz files</a></li>
<li class="toc-level-3"><a href="07_03_02_00_playing-sfz-events.html"class="toc-entry">Playing sfz events</a></li>
</ul>
</li>
<li class="toc-level-2"><a href="07_04_00_00_cl-poolplayer.html"class="toc-entry">cl-poolplayer</a></li>
<li class="toc-level-2"><a href="07_05_00_00_cl-plot.html"class="toc-entry">cl-plot</a></li>
<li class="toc-level-2"><a href="07_06_00_00_orm-utils.html"class="toc-entry">orm-utils</a></li>
</ul>
</li>
</ul>
</div>
</nav>
<header>
<h1 class="title">Clamps Packages</h1>
</header><div id="page-main-body"><nav id="nav-left"><a href="07_02_04_00_the-bang-object-class.html" class="nav-left"><i class="angle-left"></i></a></nav>
<div id="page-text-body"><div id="outline-container-orgb838d65" class="outline-3">
<h3 id="orgb838d65">cl-sfz</h3>
<div class="outline-text-3" id="text-orgb838d65">
<p>
cl-sfz implements the basic infrastructure to deal with <a href="https://en.wikipedia.org/wiki/SFZ_(file_format)">SFZ</a>
definitions. The SFZ format was developed in the context of
software samplers. Like the sf2 format it defines a mapping of
pitched samples to the keynums of a software synthesizer. If a
sample is mapped to more than one keynum, the desired pitch is
achieved by changing the playback speed of the sample.
</p>

<p>
The SFZ format uses a plain text file to define keynum regions and
their samples in addition to the base keynum, a pitch offset and an
amplitude of the recording and other playback information<sup><a id="fnr.1.7" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Example of an entry for a keynum region in a SFZ file.</label><pre class="src src-bash">&lt;region&gt;
<span class="org-variable-name">sample</span>=samples/p200-piano-d3-l-.wav
<span class="org-variable-name">lokey</span>=35 <span class="org-variable-name">hikey</span>=38
<span class="org-variable-name">pitch_keycenter</span>=38
<span class="org-variable-name">pan</span>=-100
<span class="org-variable-name">ampeg_hold</span>=2.80079
<span class="org-variable-name">ampeg_decay</span>=44.9941
<span class="org-variable-name">ampeg_sustain</span>=0.001
<span class="org-variable-name">offset</span>=0
<span class="org-variable-name">end</span>=193115
<span class="org-variable-name">loop_start</span>=158947
<span class="org-variable-name">loop_end</span>=193110
</pre>
</div>

<p>
When loading a sfz file, Clamps parses this information from the
file and creates an array of 128 lists containing <a href="../clamps-dict/lsample.html">lsample</a> structs
as a lookup table for the 128 keynums. A lsample struct holds the
<i>name</i> of the sample, its loaded <i>buffer</i>, a <i>oneshot</i> flag
indicating whether to play back the lsample once or using the loop
points, the <i>keynum</i> of the buffer adjusted to the pitch-offset of
the sfz entry, the <i>amplitude</i> in dB of the sample and its <i>start-</i>
and <i>endpoints</i> for looping. Clamps keeps a list of lsample structs
for each keynum, as the sfz format allows the mapping of more than
one sample to the same keynum. When playing back an sfz entry,
Clamps will randomly select the sample to use from this list.
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>first <span class="org-rainbow-delimiters-depth-2">(</span>aref <span class="org-rainbow-delimiters-depth-3">(</span>get-sfz-preset <span class="org-builtin">:yamaha-grand-piano</span><span class="org-rainbow-delimiters-depth-3">)</span> 35<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">=&gt; #S(lsample
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:name "p200-piano-d3-r-.wav"
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:buffer #&lt;incudine:buffer :FRAMES 193116 :CHANNELS 1 :SR 32000.0&gt;
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:oneshot nil
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:keynum 38.0d0
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:loopstart 158947.0d0
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:amp 0.0d0
</span><span class="org-comment-delimiter">;;        </span><span class="org-comment">:loopend 193110.0d0)
</span>
</pre>
</div>

<p>
Note that other features of the SFZ format like defining
modulations, envelopes, etc. are currently ignored by the clamps
importer.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
events are instances of objects derived from the <i>event</i> class.
</p></div></div>


</div>
</div></div><nav id="nav-right"><a href="07_03_01_00_loading-sfz-files.html" class="nav-right"><i class="angle-right"></i></a></nav></div></div>
</body>
</html>
